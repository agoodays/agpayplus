import{_ as e,u as t,c as a,s as o,a as s,r as n,b as l,d as r,w as c,i,o as d,e as h,f as p,n as g,g as m,h as u,j as f,k as H}from"./index-Cfcg06QB.js";const P=e({data:()=>({themeColor:"",isMiniProgram:!1,contentPaddingTop:0,fixedTopBgHeight:6.625*t(33.28)}),onLoad(e){console.log(a),this.themeColor=a.themeColor,this.isMiniProgram=a.isMiniProgram},computed:{totalTopBgHeight(){return this.contentPaddingTop+this.fixedTopBgHeight}},methods:{handleHeaderHeight(e){this.contentPaddingTop=e},parseUrl(e){const[t,a]=e.split("?"),o={};return a&&a.split("&").forEach((e=>{const[t,a]=e.split("=");o[decodeURIComponent(t)]=decodeURIComponent(a||"")})),{path:t,params:o}},extractTargetPath(e){const t=e.match(/\/pages\/[\w\/-]+(\?[\w&=]*)?/),a=t?t[0]:null;if(a){const e=a.replace(/^pages/,"/pages").replace(/\/\?/,"?").replace(/(%20|\+)/g,"").replace(/[?&]$/,"");if(!/^\/pages\/\w+\/[\w-]+(\?[\w=&]*)?$/.test(e))return;return e}return a},normalizePath(e){const t=e.split("/"),a=t.indexOf("pages");return"/"+t.slice(a).join("/")},parseScanUrl(e){const t=this.extractTargetPath(e);console.log("rawPath",t);const a=this.normalizePath(t.split("?")[0])+t.slice(t.indexOf("?"));console.log("normalizedPath",a);const o=a.split("?")[0];return console.log("basePath",o),["/pages/hub/default","/pages/hub/h5","/pages/hub/lite"].includes(o)?a:null},handleScanCode(){o({success:e=>{console.log("扫码成功",e);const t=e.result;console.log("扫码结果",t);try{const e=this.parseScanUrl(t);if(!e)return void s({title:"无效的支付链接",icon:"none"});const o=this.parseUrl(t);console.log(o.path),console.log(o.params);o.params[a.tokenKey]?n({url:e}):s({title:"二维码无效",icon:"none"})}catch(o){s({title:"非合法链接",icon:"none"}),console.error("解析二维码失败",o)}},fail:e=>{s({title:"扫码失败",icon:"none"}),console.error("扫码失败",e)}})}}},[["render",function(e,t,a,o,s,n){const P=l("CustomHeader"),y=i,C=u,x=f,w=H;return d(),r(y,{class:"container"},{default:c((()=>[s.isMiniProgram?(d(),r(P,{key:0,title:"向商家付款",bgColor:s.themeColor,onHeaderHeight:n.handleHeaderHeight},null,8,["bgColor","onHeaderHeight"])):h("",!0),p(y,{class:"content",style:g({paddingTop:s.contentPaddingTop+"px"})},{default:c((()=>[p(y,{class:"content-top-bg",style:g({height:n.totalTopBgHeight+"px",backgroundColor:s.themeColor})},null,8,["style"]),p(y,{class:"tips"},{default:c((()=>[p(y,{class:"tips-title",style:g({color:s.themeColor})},{default:c((()=>[m("欢迎使用聚合收银台")])),_:1},8,["style"]),p(y,{class:"tips-image"},{default:c((()=>[p(C,{src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20150%20150'%20class='design-iconfont'%3e%3cdefs%3e%3cclipPath%20id='k8kvqmo4ja'%3e%3cpath%20data-name='矩形%202139'%20transform='translate(300%20382)'%20fill='%23fff'%20stroke='%23707070'%20d='M0%200H150V150H0z'/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20data-name='蒙版组%201'%20transform='translate(-300%20-382)'%20clip-path='url(%23k8kvqmo4ja)'%20fill='%23212e2c'%3e%3cpath%20data-name='矩形%202130%20-%20轮廓'%20d='M10,10V40H40V10H10M10,0H40A10,10,0,0,1,50,10V40A10,10,0,0,1,40,50H10A10,10,0,0,1,0,40V10A10,10,0,0,1,10,0Z'%20transform='translate(300%20482)'%20opacity='.25'/%3e%3crect%20data-name='矩形%202131'%20width='150'%20height='10'%20rx='5'%20transform='translate(300%20454)'%20opacity='.5'/%3e%3cpath%20data-name='联合%2030'%20d='M-1560,150h-14a5,5,0,0,1-5-5,5,5,0,0,1,5-5h14V102a5,5,0,0,1,5-5,5,5,0,0,1,5,5v38A10,10,0,0,1-1560,150Zm0-102V10h-38a5,5,0,0,1-5-5,5,5,0,0,1,5-5h38a10,10,0,0,1,10,10V48a5,5,0,0,1-5,5A5,5,0,0,1-1560,48Zm-140,0V10a10,10,0,0,1,10-10h38a5,5,0,0,1,5,5,5,5,0,0,1-5,5h-38V48a5,5,0,0,1-5,5A5,5,0,0,1-1700,48Z'%20transform='translate(2000%20382)'%20opacity='.5'/%3e%3crect%20data-name='矩形%202138'%20width='18'%20height='10'%20rx='5'%20transform='rotate(180%20202.5%20266)'%20opacity='.25'/%3e%3c/g%3e%3c/svg%3e"})])),_:1}),s.isMiniProgram?(d(),r(x,{key:0,class:"scan-btn",style:g({backgroundColor:s.themeColor}),onClick:t[0]||(t[0]=e=>n.handleScanCode())},{default:c((()=>[m("扫码付款")])),_:1},8,["style"])):(d(),r(y,{key:1,class:"tips-content"},{default:c((()=>[p(w,null,{default:c((()=>[m("请使用手机")])),_:1}),p(w,null,{default:c((()=>[m("扫描聚合收款码进入")])),_:1})])),_:1}))])),_:1})])),_:1},8,["style"])])),_:1})}],["__scopeId","data-v-2ddfbc56"]]);export{P as default};
