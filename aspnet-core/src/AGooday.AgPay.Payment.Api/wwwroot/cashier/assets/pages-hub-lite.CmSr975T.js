import{_ as e,c as o,l as a,m as s,r as t,d as r,o as d,i as n}from"./index-Cfcg06QB.js";import{a as c}from"./index.iuDkB73E.js";const l=e({data:()=>({}),onLoad(e){this.redirectToCheckout()},methods:{redirectToCheckout(){"wxpay"===o.payWay.wayCode&&getOpenId(),"alipay"===o.payWay.wayCode&&getUserId()},getOpenId(){a({provider:"weixin",success:e=>{const o=e.code;console.log("code:",o),this.getChannelUserId({code:o})},fail:e=>{console.error("登录失败:",e)}})},getUserId(){my.getAuthCode({scopes:["auth_user"],success:e=>{const o=e.authCode;console.log("authCode:",o),this.getChannelUserId({auth_code:o})},fail:e=>{console.error("获取 authCode 失败:",e)}})},getChannelUserId(e){c({wayCode:o.payWay.wayCode,token:o.tokenValue,...e}).then((e=>{console.log(e),o.channelUserId=e,s("channelUserId",e),t({url:"/pages/payway/index"})})).catch((e=>{t({url:"/pages/error/index?errInfo="+e.msg})}))}}},[["render",function(e,o,a,s,t,c){const l=n;return d(),r(l)}],["__scopeId","data-v-6bf7b747"]]);export{l as default};
